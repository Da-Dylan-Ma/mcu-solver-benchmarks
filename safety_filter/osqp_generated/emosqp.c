/*
 * This file was autogenerated by OSQP on Mon Feb 19 15:54:54 2024
 * 
 * This file contains a sample solver to run the embedded code.
 */

#include <stdio.h>
#include "osqp.h"
#include "osqp_data_workspace.h"



void compute_q(OSQPFloat q[], OSQPFloat R_data[], OSQPFloat uref[])
// Xref is Nh x Nx, pointer at current step
// q is Nh x (Nx + 1) + Nh x Nu
// Q_data is Nx x Nx
{
  for (int i = 0; i < NHORIZON; ++i)
  {
    matrix_vector_reset_mult(NSTATES, NSTATES, Q_data, Xref + (i * NSTATES), q + (i * NSTATES));
  }
  matrix_vector_reset_mult(NSTATES, NSTATES, Qf_data, Xref + ((NHORIZON)*NSTATES), q + ((NHORIZON)*NSTATES));
}

int main() {
  OSQPInt exitflag;

  printf( "Embedded test program for vector updates.\n");

  exitflag = osqp_solve( &osqp_data_solver );

  if( exitflag > 0 ) {
    printf( "  OSQP errored: %s\n", osqp_error_message(exitflag));
    return (int)exitflag;
  } else {
    printf( "  Solved workspace with no error.\n" );
  }
  for (int i = 0; i < 267; i++) {
    printf("  Solution: %f\n", osqp_data_solver.solution->x[i]);
  }
  // printf("  Solution: %f\n", osqp_data_solver.solution->x[0]);
}
